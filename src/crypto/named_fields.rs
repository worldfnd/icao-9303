//! See <https://www.rfc-editor.org/rfc/rfc5114#section-2.1>
//! All these groups are of prime order with a generator for a prime-order
//! subgroup.

use ruint::{
    aliases::{U1024, U160, U2048, U256},
    uint, Uint,
};

type U224 = Uint<224, 4>;

pub struct Group<U, V> {
    pub modulus:   U,
    pub generator: U,
    pub order:     V,
}

const GROUP_1: Group<U1024, U160> = uint!(Group {
    modulus: 0xB10B8F96_A080E01D_DE92DE5E_AE5D54EC_52C99FBC_FB06A3C6_9A6A9DCA_52D23B61_6073E286_75A23D18_9838EF1E_2EE652C0_13ECB4AE_A9061123_24975C3C_D49B83BF_ACCBDD7D_90C4BD70_98488E9C_219A7372_4EFFD6FA_E5644738_FAA31A4F_F55BCCC0_A151AF5F_0DC8B4BD_45BF37DF_365C1A65_E68CFDA7_6D4DA708_DF1FB2BC_2E4A4371_U1024,
    generator: 0xA4D1CBD5_C3FD3412_6765A442_EFB99905_F8104DD2_58AC507F_D6406CFF_14266D31_266FEA1E_5C41564B_777E690F_5504F213_160217B4_B01B886A_5E91547F_9E2749F4_D7FBD7D3_B9A92EE1_909D0D22_63F80A76_A6A24C08_7A091F53_1DBF0A01_69B6A28A_D662A4D1_8E73AFA3_2D779D59_18D08BC8_858F4DCE_F97C2A24_855E6EEB_22B3B2E5_U1024,
    order: 0xF518AA87_81A8DF27_8ABA4E7D_64B7CB9D_49462353_U160,
});

const GROUP_2: Group<U2048, U224> = uint!(Group {
    modulus: 0xAD107E1E_9123A9D0_D660FAA7_9559C51F_A20D64E5_683B9FD1_B54B1597_B61D0A75_E6FA141D_F95A56DB_AF9A3C40_7BA1DF15_EB3D688A_309C180E_1DE6B85A_1274A0A6_6D3F8152_AD6AC212_9037C9ED_EFDA4DF8_D91E8FEF_55B7394B_7AD5B7D0_B6C12207_C9F98D11_ED34DBF6_C6BA0B2C_8BBC27BE_6A00E0A0_B9C49708_B3BF8A31_70918836_81286130_BC8985DB_1602E714_415D9330_278273C7_DE31EFDC_7310F712_1FD5A074_15987D9A_DC0A486D_CDF93ACC_44328387_315D75E1_98C641A4_80CD86A1_B9E587E8_BE60E69C_C928B2B9_C52172E4_13042E9B_23F10B0E_16E79763_C9B53DCF_4BA80A29_E3FB73C1_6B8E75B9_7EF363E2_FFA31F71_CF9DE538_4E71B81C_0AC4DFFE_0C10E64F_U2048,
    generator: 0xAC4032EF_4F2D9AE3_9DF30B5C_8FFDAC50_6CDEBE7B_89998CAF_74866A08_CFE4FFE3_A6824A4E_10B9A6F0_DD921F01_A70C4AFA_AB739D77_00C29F52_C57DB17C_620A8652_BE5E9001_A8D66AD7_C1766910_1999024A_F4D02727_5AC1348B_B8A762D0_521BC98A_E2471504_22EA1ED4_09939D54_DA7460CD_B5F6C6B2_50717CBE_F180EB34_118E98D1_19529A45_D6F83456_6E3025E3_16A330EF_BB77A86F_0C1AB15B_051AE3D4_28C8F8AC_B70A8137_150B8EEB_10E183ED_D19963DD_D9E263E4_770589EF_6AA21E7F_5F2FF381_B539CCE3_409D13CD_566AFBB4_8D6C0191_81E1BCFE_94B30269_EDFE72FE_9B6AA4BD_7B5A0F1C_71CFFF4C_19C418E1_F6EC0179_81BC087F_2A7065B3_84B890D3_191F2BFA_U2048,
    order: 0x801C0D34_C58D93FE_99717710_1F80535A_4738CEBC_BF389A99_B36371EB_U224,
});

const GROUP_3: Group<U2048, U256> = uint!(Group {
    modulus: 0x87A8E61D_B4B6663C_FFBBD19C_65195999_8CEEF608_660DD0F2_5D2CEED4_435E3B00_E00DF8F1_D61957D4_FAF7DF45_61B2AA30_16C3D911_34096FAA_3BF4296D_830E9A7C_209E0C64_97517ABD_5A8A9D30_6BCF67ED_91F9E672_5B4758C0_22E0B1EF_4275BF7B_6C5BFC11_D45F9088_B941F54E_B1E59BB8_BC39A0BF_12307F5C_4FDB70C5_81B23F76_B63ACAE1_CAA6B790_2D525267_35488A0E_F13C6D9A_51BFA4AB_3AD83477_96524D8E_F6A167B5_A41825D9_67E144E5_14056425_1CCACB83_E6B486F6_B3CA3F79_71506026_C0B857F6_89962856_DED4010A_BD0BE621_C3A3960A_54E710C3_75F26375_D7014103_A4B54330_C198AF12_6116D227_6E11715F_693877FA_D7EF09CA_DB094AE9_1E1A1597_U2048,
    generator: 0x3FB32C9B_73134D0B_2E775066_60EDBD48_4CA7B18F_21EF2054_07F4793A_1A0BA125_10DBC150_77BE463F_FF4FED4A_AC0BB555_BE3A6C1B_0C6B47B1_BC3773BF_7E8C6F62_901228F8_C28CBB18_A55AE313_41000A65_0196F931_C77A57F2_DDF463E5_E9EC144B_777DE62A_AAB8A862_8AC376D2_82D6ED38_64E67982_428EBC83_1D14348F_6F2F9193_B5045AF2_767164E1_DFC967C1_FB3F2E55_A4BD1BFF_E83B9C80_D052B985_D182EA0A_DB2A3B73_13D3FE14_C8484B1E_052588B9_B7D2BBD2_DF016199_ECD06E15_57CD0915_B3353BBB_64E0EC37_7FD02837_0DF92B52_C7891428_CDC67EB6_184B523D_1DB246C3_2F630784_90F00EF8_D647D148_D4795451_5E2327CF_EF98C582_664B4C0F_6CC41659_U2048,
    order: 0x8CF83642_A709A097_B4479976_40129DA2_99B1A47D_1EB3750B_A308B0FE_64F5FBD3_U256,
});

#[cfg(test)]
mod tests {
    use {
        super::*,
        crate::crypto::mod_ring::{ModRing, RingRefExt, UintExp, UintMont},
        subtle::ConditionallySelectable,
    };

    fn test_order<U, V>(group: Group<U, V>)
    where
        U: UintMont + ConditionallySelectable,
        V: UintMont + UintExp,
    {
        let field = ModRing::from_modulus(group.modulus);
        let generator = field.from(group.generator);
        let power = generator.pow_ct(group.order);
        assert_eq!(power, field.one());
    }

    #[test]
    fn test_group_1_order() {
        test_order(GROUP_1);
    }

    #[test]
    fn test_group_2_order() {
        test_order(GROUP_2);
    }

    #[test]
    fn test_group_3_order() {
        test_order(GROUP_3);
    }
}
